
<table id="customers">
    <thead class="thead-dark">
        <tr>
            @*<th scope="col">#</th>*@
            <th scope="col">Name</th>
            <th scope="col">Image</th>
            <th scope="col">Price</th>
            <th scope="col">Promation Price</th>
            <th scope="col">Quantity</th>
            <th scope="col">Sub Total</th>
            <th scope="col"></th>
            <th scope="col"></th>
        </tr>
    </thead>
    <tbody>
        @if (ViewData["cart"] != null)
        {
            @foreach (var item in (ViewData["cart"] as List<CartItem>))
            {
                <tr>
                    @*<th scope="row">1</th>*@
                    <td>@item.Product.Name</td>
                    <td><img src="@item.Product.ImageUrl" width="60" /> </td>
                    <td>$@item.Product.Price.00</td>
                    <td>$@item.Product.PromotionPrice.00</td>
                    <td>

                        <input id="input-@item.Product.Id" type="number" value="@item.Quantity" min="1" max="@item.Product.Quantity">
                    </td>
                    <td>$@item.Price.00</td>
                    <td><button class="button-remove">Remove</button></td>
                    <td><button data-id="@item.Product.Id" class="button-update">Update</button></td>
                </tr>
            }
        }


    </tbody>
</table>
@section Scripts {
<script>
    $(document).ready(function () {
        $(".button-remove").click();

        $(".button-update").click(function (event){
            event.preventDefault();
            let id = $(this).data("id");
            let quantity = $("#input-"+id).val();
            $.ajax({
                url: "/Cart/UpdateCart",
                method: "PUT",
                data{
                    id: id,
                    quantity = quantity,
                },
                success:function(){
                    Swal.fire({
                            position: 'top-end',
                            icon: 'success',
                            title: 'Add new item success',
                            showConfirmButton: false,
                            timer: 1500
                            })
                },
                error: function(){
                    Swal.fire({
                        position: 'top-end',
                        icon: 'error',
                        title: 'Update failed',
                        showConfirmButton: false,
                        timer: 1500
                            })
                }
            })
        });
    })
</script>
}
